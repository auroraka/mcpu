library IEEE;
use IEEE.STD_LOGIC_1164.ALL;
USE IEEE.STD_LOGIC_ARITH.ALL;
USE IEEE.STD_LOGIC_UNSIGNED.all;
library WORK;
use WORK.src.PACK.ALL ;

entity pc is port(
	stall:		in		std_logic;
	clk:		in 		std_logic;
	rst:		in 		std_logic;
	branch_flag_o:	in	std_logic;
	branch_addr_o:	in	InstAddrBus;
	pc:				out InstAddrBus;
	ce:				out std_logic
);
end pc;

architecture Behavioral of pc is
	signal pc_sig: InstAddrBus;
begin
	process(clk)
	begin
		if rising_edge(clk)	then	
			if rst = RstEnable then
				ce <= ChipDisable;
			else
				ce <= ChipEnable;
			end if;
		end if;
	end process;
	
	process(clk)
	begin
		if rising_edge(clk)	then
			if stall = StallNo then
				if branch_flag_o = BranchFlagUp then
					pc <= branch_addr_o;
				else
					pc <= pc + '1';
				end if;
			end if;
		end if;
	end process;
end Behavioral;